Requirement already satisfied: torch in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (2.0.1)
Requirement already satisfied: numpy in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (1.24.4)
Requirement already satisfied: transformers in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (4.30.2)
Requirement already satisfied: datasets in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (2.13.1)
Requirement already satisfied: tiktoken in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (0.4.0)
Requirement already satisfied: wandb in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (0.15.4)
Requirement already satisfied: tqdm in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (4.65.0)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (10.2.10.91)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.10.3.66)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.7.4.91)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.7.99)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (2.14.3)
Requirement already satisfied: triton==2.0.0; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (2.0.0)
Requirement already satisfied: filelock in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (3.12.2)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (10.9.0.58)
Requirement already satisfied: sympy in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (1.12)
Requirement already satisfied: networkx in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (3.1)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.7.91)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.4.0.1)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.7.99)
Requirement already satisfied: typing-extensions in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (4.7.1)
Requirement already satisfied: jinja2 in /usr/lib/python3/dist-packages (from torch) (2.10.1)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101; platform_system == "Linux" and platform_machine == "x86_64" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from torch) (11.7.101)
Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from transformers) (0.13.3)
Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from transformers) (0.16.2)
Requirement already satisfied: safetensors>=0.3.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from transformers) (0.3.1)
Requirement already satisfied: regex!=2019.12.17 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from transformers) (2023.6.3)
Requirement already satisfied: requests in /usr/lib/python3/dist-packages (from transformers) (2.22.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/lib/python3/dist-packages (from transformers) (5.3.1)
Requirement already satisfied: packaging>=20.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from transformers) (23.1)
Requirement already satisfied: multiprocess in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (0.70.14)
Requirement already satisfied: fsspec[http]>=2021.11.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (2023.6.0)
Requirement already satisfied: dill<0.3.7,>=0.3.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (0.3.6)
Requirement already satisfied: pyarrow>=8.0.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (12.0.1)
Requirement already satisfied: pandas in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (2.0.3)
Requirement already satisfied: aiohttp in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (3.8.4)
Requirement already satisfied: xxhash in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from datasets) (3.2.0)
Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from wandb) (45.2.0)
Requirement already satisfied: sentry-sdk>=1.0.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (1.27.0)
Requirement already satisfied: docker-pycreds>=0.4.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (0.4.0)
Requirement already satisfied: appdirs>=1.4.3 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (1.4.4)
Requirement already satisfied: pathtools in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (0.1.2)
Requirement already satisfied: Click!=8.0.0,>=7.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (8.1.3)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (3.1.31)
Requirement already satisfied: setproctitle in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (1.3.2)
Requirement already satisfied: psutil>=5.0.0 in /usr/lib/python3/dist-packages (from wandb) (5.5.1)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.12.0; python_version < "3.9" and sys_platform == "linux" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from wandb) (4.23.3)
Requirement already satisfied: wheel in /usr/lib/python3/dist-packages (from nvidia-curand-cu11==10.2.10.91; platform_system == "Linux" and platform_machine == "x86_64"->torch) (0.34.2)
Requirement already satisfied: lit in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from triton==2.0.0; platform_system == "Linux" and platform_machine == "x86_64"->torch) (16.0.6)
Requirement already satisfied: cmake in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from triton==2.0.0; platform_system == "Linux" and platform_machine == "x86_64"->torch) (3.26.4)
Requirement already satisfied: mpmath>=0.19 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from sympy->torch) (1.3.0)
Requirement already satisfied: pytz>=2020.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from pandas->datasets) (2023.3)
Requirement already satisfied: python-dateutil>=2.8.2 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from pandas->datasets) (2.8.2)
Requirement already satisfied: tzdata>=2022.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from pandas->datasets) (2023.3)
Requirement already satisfied: aiosignal>=1.1.2 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (4.0.2)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (3.1.0)
Requirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp->datasets) (19.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.3.3)
Requirement already satisfied: multidict<7.0,>=4.5 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (6.0.4)
Requirement already satisfied: yarl<2.0,>=1.0 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from aiohttp->datasets) (1.9.2)
Requirement already satisfied: urllib3>=1.26.11; python_version >= "3.6" in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from sentry-sdk>=1.0.0->wandb) (2.0.3)
Requirement already satisfied: certifi in /usr/lib/python3/dist-packages (from sentry-sdk>=1.0.0->wandb) (2019.11.28)
Requirement already satisfied: six>=1.4.0 in /usr/lib/python3/dist-packages (from docker-pycreds>=0.4.0->wandb) (1.14.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb) (4.0.10)
Requirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.0->aiohttp->datasets) (2.8)
Requirement already satisfied: smmap<6,>=3.0.1 in /orfeo/cephfs/home/dssc/valinsogna/.local/lib/python3.8/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb) (5.0.0)
master_addr is only used for static rdzv_backend and when rdzv_endpoint is not specified.
Overriding config with config/train_whatsapp3.py:
# Train on 1 GPU

#####################################################################
# CHANGED default parameters from train.py model:
#####################################################################
out_dir = 'out-whatsapp3'
dataset = 'whatsapp'
wandb_project = 'whatsapp3'
wandb_run_name='gpt2-124M-3'

# we expect to overfit on this small dataset, so only save when val improves
always_save_checkpoint = False

# baby GPT model :)
n_layer = 6
n_head = 6
n_embd = 384
dropout = 0.2

# bias = False
min_lr = 1e-4 # learning_rate / 10 usually
beta2 = 0.99 # make a bit bigger because number of tokens per iter is small
max_iters = 5000
lr_decay_iters = 5000 # make equal to max_iters usually

# eval stuff
eval_interval = 250 # keep frequent because we'll overfit
eval_iters = 200
log_interval = 10 # don't print too too often
# this makes total number of tokens be 300B (recalculate for whatsapp)
warmup_iters = 100

gradient_accumulation_steps = 1
batch_size = 64
block_size = 256 # context of up to 256 previous characters

#####################################################################
# UNCHANGED default parameters from train.py model:
#####################################################################
wandb_log = False

# weight decay
weight_decay = 1e-1

tokens per iteration will be: 16,384
Initializing a new model from scratch
defaulting to vocab_size of GPT-2 to 50304 (50257 rounded up for efficiency)
number of parameters: 29.94M
num decayed parameter tensors: 26, with 30,031,872 parameters
num non-decayed parameter tensors: 13, with 4,992 parameters
using fused AdamW: True
compiling the model... (takes a ~minute)
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.0.3) or chardet (5.1.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
